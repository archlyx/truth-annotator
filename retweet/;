var Parse = require('parse').Parse;

var ANNOTATION_TABLE_NAME= "Annotation";
var USER_TABLE_NAME = "User";
var USER_ANNOTATION_TABLE_NAME = "UserAnnotation";

Parse.initialize("Jbz8IatuSOpr7xmnNXBpnCcN1cj2ox9sPzsqggak", "anMcouVSWbzeHoJmFJBcJYrmg8XtzUatOt7hrgJX");

function getAnnotations(lastTime) {

  var Annotation = Parse.Object.extend(ANNOTATION_TABLE_NAME);
  var query = new Parse.Query(Annotation);
    query.equalTo("hostDomain", "twitter.com");
    if (lastTime != undefined)
      //console.log("lastTime is not empty");
      query.greaterThan("createdAt", lastTime);
    query.descending("createdAt");
    query.find({
      success: function(results) {
        console.log(results.length);
        for(var i = 0; i < 5; i++){
          console.log(results[i].createdAt);
          console.log(results[i].get('postId'));
        }
      }
    });
}

exports.getAnnotations = getAnnotations;
